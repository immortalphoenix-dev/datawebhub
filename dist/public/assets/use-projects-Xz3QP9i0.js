import{j as e,L as t,r as s}from"./index-BSgtn-Ll.js";import{E as r}from"./external-link-ChbVgU0-.js";import{u as o}from"./useQuery-5zBLpZNe.js";function a({project:s}){const{title:o,description:a,imageUrl:n,technologies:i=[],demoUrl:c,$id:l}=s,d=a&&a.length>120,p=d?(null==a?void 0:a.substring(0,120))+"...":a;return e.jsx(t,{href:`/projects/${l}`,className:"block h-full",children:e.jsxs("div",{className:"project-card bg-card rounded-2xl overflow-hidden border shadow-sm transition-all duration-300 hover:shadow-xl hover:-translate-y-1 h-full opacity-100 relative z-10 cursor-pointer",style:{opacity:1,visibility:"visible"},children:[e.jsx("img",{src:null==n?void 0:n.replace("/download?","/view?"),alt:`${o} - ${a}`,className:"w-full h-56 object-cover block opacity-100",loading:"lazy",decoding:"async",sizes:"(max-width: 1024px) 100vw, 33vw",onError:e=>{console.log("Image failed to load:",n),e.currentTarget.src=`https://placehold.co/400x300?text=${encodeURIComponent(o)}`}}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"font-heading text-lg md:text-xl font-bold text-card-foreground mb-2","data-testid":`text-project-title-${l}`,children:o}),e.jsx("p",{className:"text-muted-foreground mb-4 text-sm md:text-base leading-relaxed","data-testid":`text-project-description-${l}`,children:p}),d&&e.jsx("div",{className:"text-primary text-sm font-semibold mb-4",children:"Read More"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:i.map(t=>e.jsx("span",{className:"px-3 py-1 text-sm rounded-full bg-secondary text-secondary-foreground","data-testid":`tech-${t.toLowerCase()}-${l}`,children:t},t))}),e.jsx("div",{className:"flex gap-4",children:c&&e.jsxs("a",{href:c,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),"data-testid":`link-demo-${l}`,className:"inline-flex items-center justify-center rounded-md border border-input bg-background px-3 py-1.5 text-sm font-medium ring-offset-background transition-colors hover:bg-accent hover:text-accent-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",children:[e.jsx(r,{className:"w-4 h-4 mr-2"}),"Live Demo"]})})]})]})})}function n(e){const[t,r]=s.useState(),[o,a]=s.useState(!0),[n,i]=s.useState(null);return s.useEffect(()=>{(async()=>{try{a(!0),i(null);const t=sessionStorage.getItem("prefetched-projects");if(t)try{const e=JSON.parse(t);r(e.items)}catch{}const s=e&&"all"!==e?`/api/projects/category/${e}`:"/api/projects",o=await fetch(s);if(!o.ok)throw new Error(`Failed to fetch projects: ${o.status}`);const n=await o.json();r(n)}catch(t){console.error("useProjects: Error fetching projects:",t),i(t)}finally{a(!1)}})()},[e]),{data:t,isLoading:o,error:n}}function i(){return o({queryKey:["projects","featured"],queryFn:async()=>{const e=await fetch("/api/projects");if(!e.ok)throw new Error(`Failed to fetch projects: ${e.status}`);return e.json()},staleTime:3e5})}async function c(){try{const e=await fetch("/api/projects");if(!e.ok)return;const t=await e.json();sessionStorage.setItem("prefetched-projects",JSON.stringify({ts:Date.now(),items:t}))}catch(e){}}export{a as P,n as a,c as p,i as u};
