import{c as e,r as t,j as s,b as a,q as r,i}from"./index-BSgtn-Ll.js";import{B as d}from"./button-Bgi_n9zI.js";import{I as o}from"./input-Bfcs3fBg.js";import{L as l,a as n}from"./appwrite-DBggR3Ar.js";import{u as c}from"./useQuery-5zBLpZNe.js";import{L as p}from"./loader-circle-CrkRQJ5h.js";import"./index-D-75ZohY.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m=e("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),u=e("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),x=t.forwardRef(({className:e,...t},r)=>s.jsx("textarea",{className:a("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function h(){const[e,a]=t.useState(!1),[h,j]=t.useState(!0),[g,y]=t.useState(""),[f,v]=t.useState(""),[b,N]=t.useState("web"),[w,A]=t.useState(""),[k,S]=t.useState(null),[T,P]=t.useState(""),[F,C]=t.useState(""),[U,q]=t.useState(!1),[D,E]=t.useState(""),[I,$]=t.useState(""),[L,M]=t.useState(!0),[O,z]=t.useState(!1),[K,Q]=t.useState(null),{toast:R}=r(),H=i();t.useEffect(()=>{(async()=>{try{if(!n)return console.warn("Authentication not configured"),void(window.location.href="/admin/login");await n.get(),a(!0)}catch(e){window.location.href="/admin/login"}finally{j(!1)}})()},[]);const{data:V,isLoading:Y,error:B}=c({queryKey:["prompts"],queryFn:async()=>{const e=await fetch("/api/prompts");if(!e.ok)throw new Error("Failed to fetch prompts");return e.json()}});if(h)return s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx(p,{className:"h-8 w-8 animate-spin"})});if(!e)return null;return s.jsx("section",{className:"py-12 bg-background",children:s.jsxs("div",{className:"container mx-auto px-6 lg:px-8",children:[s.jsx("div",{className:"mb-8",children:s.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Admin Dashboard"})}),s.jsxs("div",{className:"bg-card p-4 md:p-8 rounded-2xl shadow-lg border mb-8",children:[s.jsx("h2",{className:"text-2xl font-bold text-card-foreground mb-6",children:"Upload New Project"}),s.jsxs("form",{onSubmit:async e=>{e.preventDefault(),q(!0);const t=new FormData;t.append("title",g),t.append("description",f),t.append("category",b),t.append("technologies",w),F.trim()&&t.append("demoUrl",F.trim()),k&&t.append("image",k);try{const e=await fetch("/api/projects",{method:"POST",body:t});if(e.ok)R({title:"Project Uploaded",description:"Your new project has been added successfully."}),y(""),v(""),N("web"),A(""),S(null),C("");else{const t=await e.json();R({title:"Upload Failed",description:t.message||"An error occurred.",variant:"destructive"})}}catch(s){R({title:"An error occurred",description:"Please try again later.",variant:"destructive"})}finally{q(!1)}},className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"title",children:"Title"}),s.jsx(o,{id:"title",value:g,onChange:e=>y(e.target.value),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"category",children:"Category"}),s.jsxs("select",{id:"category",value:b,onChange:e=>N(e.target.value),className:"w-full p-2 border rounded-md",children:[s.jsx("option",{value:"web",children:"Web"}),s.jsx("option",{value:"app",children:"App"}),s.jsx("option",{value:"data analysis",children:"Data Analysis"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"description",children:"Description"}),s.jsx(x,{id:"description",value:f,onChange:e=>v(e.target.value),rows:5,required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"technologies",children:"Technologies (comma-separated)"}),s.jsx(o,{id:"technologies",value:w,onChange:e=>A(e.target.value),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"imageFile",children:"Image File (Required)"}),s.jsx(o,{id:"imageFile",type:"file",onChange:e=>S(e.target.files?e.target.files[0]:null),required:!0}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload an image for your project"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"demoUrl",children:"Demo URL (Optional)"}),s.jsx(o,{id:"demoUrl",type:"url",placeholder:"https://your-demo-link.com",value:F,onChange:e=>C(e.target.value)})]}),s.jsx(d,{type:"submit",disabled:U,children:U?"Uploading...":"Upload Project"})]})]}),s.jsxs("div",{className:"bg-card p-4 md:p-8 rounded-2xl shadow-lg border mb-8",children:[s.jsx("h2",{className:"text-2xl font-bold text-card-foreground mb-6",children:K?"Edit AI Prompt":"Add New AI Prompt"}),s.jsxs("form",{onSubmit:async e=>{e.preventDefault(),z(!0);const t={promptText:D,promptType:I,isActive:L},s=K?"PUT":"POST",a=K?`/api/prompts/${K}`:"/api/prompts";try{const e=await fetch(a,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(e.ok)R({title:"Prompt "+(K?"Updated":"Added"),description:`AI prompt has been ${K?"updated":"added"} successfully.`}),H.invalidateQueries({queryKey:["prompts"]}),E(""),$(""),M(!0),Q(null);else{const t=await e.json();R({title:`Prompt ${K?"Update":"Add"} Failed`,description:t.message||"An error occurred.",variant:"destructive"})}}catch(r){R({title:"An error occurred",description:"Please try again later.",variant:"destructive"})}finally{z(!1)}},className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"promptText",children:"Prompt Content"}),s.jsx(x,{id:"promptText",value:D,onChange:e=>E(e.target.value),rows:5,required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(l,{htmlFor:"promptType",children:"Prompt Type"}),s.jsx(o,{id:"promptType",value:I,onChange:e=>$(e.target.value),required:!0})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",id:"isActive",checked:L,onChange:e=>M(e.target.checked),className:"h-4 w-4 text-primary rounded"}),s.jsx(l,{htmlFor:"isActive",children:"Is Active"})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx(d,{type:"submit",disabled:O,children:O?K?"Updating...":"Adding...":K?"Update Prompt":"Add Prompt"}),K&&s.jsx(d,{variant:"outline",onClick:()=>{Q(null),E(""),$(""),M(!0)},children:"Cancel Edit"})]})]})]}),s.jsxs("div",{className:"bg-card p-4 md:p-8 rounded-2xl shadow-lg border",children:[s.jsx("h2",{className:"text-2xl font-bold text-card-foreground mb-6",children:"Existing AI Prompts"}),Y?s.jsx("div",{className:"flex justify-center items-center py-10",children:s.jsx(p,{className:"w-8 h-8 animate-spin text-primary"})}):B?s.jsx("div",{className:"text-center py-10",children:s.jsxs("p",{className:"text-destructive",children:["Failed to load prompts: ",B.message]})}):V&&V.length>0?s.jsx("div",{className:"space-y-4",children:V.map(e=>s.jsxs("div",{className:"p-4 border rounded-lg bg-muted/50 flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold text-card-foreground",children:["Type: ",e.promptType]}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.promptText.substring(0,100),"..."]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Active: ",e.isActive?"Yes":"No"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(d,{variant:"outline",size:"icon",onClick:()=>(e=>{Q(e.$id),E(e.promptText),$(e.promptType),M(e.isActive)})(e),children:s.jsx(m,{className:"w-4 h-4"})}),s.jsx(d,{variant:"destructive",size:"icon",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this prompt?"))try{const t=await fetch(`/api/prompts/${e}`,{method:"DELETE"});if(t.ok)R({title:"Prompt Deleted",description:"AI prompt has been deleted successfully."}),H.invalidateQueries({queryKey:["prompts"]});else{const e=await t.json();R({title:"Delete Failed",description:e.message||"An error occurred.",variant:"destructive"})}}catch(t){R({title:"An error occurred",description:"Please try again later.",variant:"destructive"})}})(e.$id),children:s.jsx(u,{className:"w-4 h-4"})})]})]},e.$id))}):s.jsx("div",{className:"text-center py-10 text-muted-foreground",children:"No prompts added yet."})]})]})})}x.displayName="Textarea";export{h as default};
